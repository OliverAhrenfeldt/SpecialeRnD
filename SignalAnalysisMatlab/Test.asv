%% Reading EDF file (From C3 patch)
data = edfread('Files/1234_301020_175117.edf');
% info = edfinfo('1234_271020_212806.edf');
% fs = info.NumSamples/seconds(info.DataRecordDuration);

% Extracting data and putting it in a single array
rowCount = height(data);

% ECG1
y1 = zeros(1,rowCount*12);
yCounter1 = 1;
for i = 1:rowCount
    row = cell2mat(data.ECG1(i))';
    for j = 1:length(row)
        y1(yCounter1) = row(j);
        yCounter1 = yCounter1 + 1;
    end
end

% ECG2
y2 = zeros(1,rowCount*12);
yCounter2 = 1;
for i = 1:rowCount
    row = cell2mat(data.ECG2(i))';
    for j = 1:length(row)
        y2(yCounter2) = row(j);
        yCounter2 = yCounter2 + 1;
    end
end

% ECG3
y3 = zeros(1,rowCount*12);
yCounter3 = 1;
for i = 1:rowCount
    row = cell2mat(data.ECG3(i))';
    for j = 1:length(row)
        y3(yCounter3) = row(j);
        yCounter3 = yCounter3 + 1;
    end
end

% Tidsakse
t = linspace(1,rowCount*12,rowCount*12);

figure(1);
plot(t(1000:length(y1)),y1(1000:length(y1)));
hold on
plot(t(1000:length(y2)),y2(1000:length(y2)));
plot(t(1000:length(y3)),y3(1000:length(y3)));
hold off

%% Reading the RAW file (From phone)

% BEGINNING OF AUTOGENERATED CODE USING IMPORT TOOL
opts = delimitedTextImportOptions("NumVariables", 4);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = " ";

% Specify column names and types
opts.VariableNames = ["Var1", "Var2", "Var3", "VarName4"];
opts.SelectedVariableNames = "VarName4";
opts.VariableTypes = ["string", "string", "string", "string"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
opts.ConsecutiveDelimitersRule = "join";
opts.LeadingDelimitersRule = "ignore";

% Specify variable properties
opts = setvaropts(opts, ["Var1", "Var2", "Var3", "VarName4"], "WhitespaceRule", "preserve");
opts = setvaropts(opts, ["Var1", "Var2", "Var3", "VarName4"], "EmptyFieldRule", "auto");

% Import the data
cortrium3010201751 = readtable("Files\cortrium301020_1751.csv", opts);
% END OF AUTOGENERATED

raw = rmmissing(

%% OLD Reading the RAW file (From phone)
% Only works on raw files that has just noise

raw = readmatrix('Files/cortrium.csv');

rawRowCount = height(raw);

% ECG1
yr1 = zeros(1,rawRowCount*12);
yrCounter1 = 1;

for i = 1:rawRowCount
    row = raw(i,21:32);
    for j = 1:length(row)
        yr1(yrCounter1) = row(j);
        yrCounter1 = yrCounter1 + 1;
    end
end

% ECG2
yr2 = zeros(1,rawRowCount*12);
yrCounter2 = 1;

for i = 1:rawRowCount
    row = raw(i,33:44);
    for j = 1:length(row)
        yr2(yrCounter2) = row(j);
        yrCounter2 = yrCounter2 + 1;
    end
end

% ECG3
yr3 = zeros(1,rawRowCount*12);
yrCounter3 = 1;

for i = 1:rawRowCount
    row = raw(i,45:56);
    for j = 1:length(row)
        yr3(yrCounter3) = row(j);
        yrCounter3 = yrCounter3 + 1;
    end
end

% Tidsakse
t = linspace(1,rawRowCount*12,rawRowCount*12);

figure(2);
% Plot
plot(t,yr1);
hold on
plot(t,yr2);
plot(t,yr3);
hold off